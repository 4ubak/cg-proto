syntax = "proto3";

package marketplace.ad.v1;

option go_package = "gitlab.com/xakpro/cg-proto/gen/go/marketplace/ad/v1";

import "google/protobuf/timestamp.proto";

service AdService {
  rpc CreateAd(CreateAdRequest) returns (CreateAdResponse);
  rpc GetAd(GetAdRequest) returns (GetAdResponse);
  rpc UpdateAd(UpdateAdRequest) returns (UpdateAdResponse);
  rpc DeleteAd(DeleteAdRequest) returns (DeleteAdResponse);
  rpc ListAds(ListAdsRequest) returns (ListAdsResponse);
  rpc SearchAds(SearchAdsRequest) returns (SearchAdsResponse);
  rpc GetUserAds(GetUserAdsRequest) returns (GetUserAdsResponse);
  rpc GetOrganizationAds(GetOrganizationAdsRequest) returns (GetOrganizationAdsResponse);
}

enum AdStatus {
  AD_STATUS_UNSPECIFIED = 0;
  AD_STATUS_DRAFT = 1;
  AD_STATUS_MODERATION = 2;
  AD_STATUS_ACTIVE = 3;
  AD_STATUS_REJECTED = 4;
  AD_STATUS_SOLD = 5;
  AD_STATUS_ARCHIVED = 6;
}

enum AdKind {
  AD_KIND_UNSPECIFIED = 0;
  AD_KIND_AUTO = 1;
  AD_KIND_PARTS = 2;
  AD_KIND_SERVICE = 3;
}

message Ad {
  int64 id = 1;
  int64 user_id = 2;
  int64 organization_id = 3;
  
  AdKind kind = 4;
  AdStatus status = 5;
  
  string title = 6;
  string description = 7;
  int64 price = 8;
  string currency = 9;
  
  string city_id = 10;
  repeated string images = 11;
  map<string, string> attributes = 12;
  
  int32 views_count = 13;
  int32 favorites_count = 14;
  
  google.protobuf.Timestamp created_at = 15;
  google.protobuf.Timestamp updated_at = 16;
}

message CreateAdRequest {
  int64 user_id = 1;
  int64 organization_id = 2;
  AdKind kind = 3;
  string title = 4;
  string description = 5;
  int64 price = 6;
  string city_id = 7;
  repeated string images = 8;
  map<string, string> attributes = 9;
}

message CreateAdResponse {
  Ad ad = 1;
}

message GetAdRequest {
  int64 ad_id = 1;
}

message GetAdResponse {
  Ad ad = 1;
}

message UpdateAdRequest {
  int64 ad_id = 1;
  int64 user_id = 2;
  optional string title = 3;
  optional string description = 4;
  optional int64 price = 5;
  repeated string images = 6;
  map<string, string> attributes = 7;
}

message UpdateAdResponse {
  Ad ad = 1;
}

message DeleteAdRequest {
  int64 ad_id = 1;
  int64 user_id = 2;
}

message DeleteAdResponse {
  bool success = 1;
}

message ListAdsRequest {
  AdKind kind = 1;
  string city_id = 2;
  int32 page = 3;
  int32 page_size = 4;
  string sort_by = 5;
}

message ListAdsResponse {
  repeated Ad ads = 1;
  int32 total = 2;
}

message SearchAdsRequest {
  string query = 1;
  AdKind kind = 2;
  string city_id = 3;
  int64 price_min = 4;
  int64 price_max = 5;
  map<string, string> filters = 6;
  int32 page = 7;
  int32 page_size = 8;
}

message SearchAdsResponse {
  repeated Ad ads = 1;
  int32 total = 2;
}

message GetUserAdsRequest {
  int64 user_id = 1;
  AdStatus status = 2;
  int32 page = 3;
  int32 page_size = 4;
}

message GetUserAdsResponse {
  repeated Ad ads = 1;
  int32 total = 2;
}

message GetOrganizationAdsRequest {
  int64 organization_id = 1;
  AdStatus status = 2;
  int32 page = 3;
  int32 page_size = 4;
}

message GetOrganizationAdsResponse {
  repeated Ad ads = 1;
  int32 total = 2;
}

